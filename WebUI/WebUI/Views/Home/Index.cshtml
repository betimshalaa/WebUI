
@{
    ViewData["Title"] = "Map";
}

<div id="map"></div>
<script src="~/lib/jquery/dist/jquery.js"></script>
<style>
    #map {
        width: 100%;
        position: static !important;
        overflow: hidden !important;
    }


    .modal-dialog {
        width: 80%;
        height: 80vh;
        vertical-align: middle;
        margin: 5% 10% 10% 10%;
        padding: 0;
    }

    .modal-content {
        height: auto;
        min-height: 80vh;
        border-radius: 5px;
        vertical-align: middle;
        background-color: #242F3E;
        border-bottom:0;
    }
</style>
<div id="myModal" class="modal fade" role="dialog" >
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content" >
            <div class="modal-header" style="border:0 !important;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="chartContainer" style="height: auto;
                          min-height: 65vh;">
                    <div class="row">
                        <div class="col-md-4">
                            
                        </div>

                    </div>
                </div>
            </div>
         
        </div>

    </div>
</div>

@section Scripts{
    <script src="~/js/echarts.js"></script>
    <script>
        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 46.483, lng: 49.43 },
                zoom: 10,
                styles: [
                    { elementType: 'geometry', stylers: [{ color: '#242f3e' }] },
                    { elementType: 'labels.text.stroke', stylers: [{ color: '#242f3e' }] },
                    { elementType: 'labels.text.fill', stylers: [{ color: '#746855' }] },

                    {
                        featureType: 'road',
                        elementType: 'geometry',
                        stylers: [{ color: '#38414e' }]
                    },
                    {
                        featureType: 'road',
                        elementType: 'geometry.stroke',
                        stylers: [{ color: '#212a37' }]
                    },
                    {
                        featureType: 'road',
                        elementType: 'labels.text.fill',
                        stylers: [{ color: '#9ca5b3' }]
                    },
                    {
                        featureType: 'road.highway',
                        elementType: 'geometry',
                        stylers: [{ color: '#746855' }]
                    },
                    {
                        featureType: 'road.highway',
                        elementType: 'geometry.stroke',
                        stylers: [{ color: '#1f2835' }]
                    },
                    {
                        featureType: 'road.highway',
                        elementType: 'labels.text.fill',
                        stylers: [{ color: '#f3d19c' }]
                    },

                    {
                        featureType: 'water',
                        elementType: 'geometry',
                        stylers: [{ color: '#17263c' }]
                    },
                    {
                        featureType: 'water',
                        elementType: 'labels.text.fill',
                        stylers: [{ color: '#515c6d' }]
                    },
                    {
                        featureType: 'water',
                        elementType: 'labels.text.stroke',
                        stylers: [{ color: '#17263c' }]
                    }
                ]

            });
            var data = `[
                    {
                        "latitude": 46.485,
                        "longitude": 49.417,
                        "acq_date": 20181013,
                        "acq_time": 2255,
                        "brightness": 317.8,
                        "daynight": "N",
                        "bright_t31": 277.4,
                        "version": "6.0NRT",
                        "instrument": "MODIS",
                        "frp": 19.8,
                        "confidence": 76,
                        "scan": 1,
                        "track": 1,
                        "satellite": "Hana"
                    },
                    {
                        "latitude": 46.494,
                        "longitude": 49.364,
                        "acq_date": 20181013,
                        "acq_time": 2255,
                        "brightness": 324.3,
                        "daynight": "N",
                        "bright_t31": 277.4,
                        "version": "6.0NRT",
                        "instrument": "MODIS",
                        "frp": 28,
                        "confidence": 88,
                        "scan": 1,
                        "track": 1,
                        "satellite": "Toka"
                    }
                    ]`;
            var infowindow = new google.maps.InfoWindow({

            });
            $.each(JSON.parse(data), function (index, value) {

                var myLatlng = new google.maps.LatLng(value.latitude, value.longitude);
                //alert(myLatlng/*);*/
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                });

                var redCircle = new google.maps.Circle({
                    strokeColor: '#FF0000',
                    strokeOpacity: 1,
                    strokeWeight: 1,
                    fillColor: '#FF0000',
                    fillOpacity: 0.35,
                    map: map,
                    center: { lat: value.latitude, lng: value.longitude },
                    radius: value.confidence * 5.5
                });
                //alert(redCircle.radius);
                //var greenCircle = new google.maps.Circle({
                //    strokeColor: '#33cc33',
                //    strokeOpacity: 0.8,
                //    strokeWeight: 2,
                //    fillColor: '#FFFF00',
                //    fillOpacity: 0.35,
                //    map: map,
                //    center: { lat: value.latitude, lng: value.longitude },
                //    radius: value.confidence * 10 + 100
                //});
                bindInfoWindow(marker, map, infowindow, "");
            });
        }
        function bindInfoWindow(marker, map, infowindow, divi) {
            marker.addListener('click', function () {
                $('#myModal').modal('show');
                showChart();

            });
            //marker.addListener('mouseover', function () {
            ////    infowindow.setContent(divi);
            ////    infowindow.open(map, this);
            ////});

        }

        function showChart() {


        }

    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDfytPh8CfSlcmsoCWeoDZlO0ddKNy7mM&callback=initMap"
            type="text/javascript"></script>
}
